- [ ] react-query f/u
- [ ] 빌드
  - [[../ios|ios]]
    - [[../apple|apple]] developer 등록없이 배포 불가
      - 승인 대기중
      - 9시간 정도 이후 이메일 옴
      - 프로그램 사용권 계약에 대해 검토 
      - 프로비저닝 프로파일은 다음을 포함있다
        - 개발자의 인증서(애플을 통해 인증되었기 때문에 폰에서 신뢰하기를 누르는 절차가 생략된다)
        - 앱의 bundle id
        - device uuid
      - 기본적으로 개발자 인증서가 하나 발급되어있다. developer.apple.com 에서는 확인하지 못했으나 xcworkspace 를 열어서보면 확인된다
        - *Signing & Capabiliteis* -> *Signing* -> *Team* 에 보면 추가되어있는 것을 확인할 수 있다
        - 선택을 하게되면 *identifiers* 리스트에 추가된 것을 확인할 수 있다
          + https://developer.apple.com/account/resources/identifiers/list
        - Product -> Archive 해본다
          - [X] 이제 Validate 진행된다
          - [X] Release Testing
            - `xcarchive` 파일이 `/Users/[USER_NAME]/Library/Developer/Xcode/Archives/[DATE]` 쪽에 저장
            - 지정한 경로로 `ipa` 파일 생성
          - [ ] Testflight Internal Only
          - [ ] Testflight & Appstore
        - [ ] Product -> Edit Schema -> Release -> Run 하게도면 디바이스 미등록 메시지가 나오고 등록을 눌러준다
          - https://developer.apple.com/account/resources/devices/list 에 추가되는 것 확인
          - 설치 실패
          - `Failed to install the app on the device.`
            - `Command Ld emitted errors but did not return a nonzero exit code to indicate failure`
            - `IDERunOperationFailingWorker = IDEInstallCoreDeviceWorker;`
            - Team 선택에서 앱스토어가 아닌 개발자 등록 이전에 쓰던 것으로는 사용가능
            - 아마도 인증서가 바뀐경우 설치된 디바이스에서 제거를 수동으로 해줘야해서 발생하는 것으로 보인다
              + https://developer.apple.com/forums/thread/739711 pod 지우고 다시 설치하라는 글도 있다

      - test flight setup
    - [[../fastlane|fastlane]] 으로 이동
    - ~~일반> 프로파일 및 기기관리 > 개발자앱> 개발자를 신뢰함> 신뢰~~
      - 일반 > VPN 및 기기 관리 -> VPN 쪽으로 이동한 것으로 추측됨
  - [[../android|android]]
      - `keytool -genkeypair -v -storetype PKCS12 -keystore my-upload-key.keystore -alias my-key-alias -keyalg RSA -keysize 2048 -validity 10000`
- [X] [[../apple|apple]] 개발자 계정 결재
- [X] android package.name 변경

- releaes 빌드를 위해 `build.properties` 에 `*.keystore` 파일에 대한 정보를 패스워드 포함해서 주입이 필요함
  ```sh 
  > Task :app:packageRelease FAILED

  FAILURE: Build failed with an exception.

  * What went wrong:
  Execution failed for task ':app:packageRelease'.
  > A failure occurred while executing com.android.build.gradle.tasks.PackageAndroidArtifact$IncrementalSplitterRunnable
     > SigningConfig "release" is missing required property "storeFile".
  ```
  - `gradle.properties` 에 선언한다,  참조하는 fastlane 과 페어로 동작
  ```sh 
  MYAPP_UPLOAD_STORE_FILE=release.keystore
  MYAPP_UPLOAD_KEY_ALIAS=release
  MYAPP_UPLOAD_STORE_PASSWORD=********
  MYAPP_UPLOAD_KEY_PASSWORD=********
  ```

- proguard
| option                    |      MB |
|---------------------------|--------:|
| debug                     |  150.91 |
| release                   |   53.16 |
| release+proguard          |   49.86 |
| release+splitted          |  max 20 |
| release+proguard+splitted |  max 17 |
