# firebase-app-check
+ [[diary:2024-01-01]]

## 컨셉
- 디바이스에 인증개념을 도입해서 해당 앱으로부터 정상적으로 발송된 트래픽인지를 확인하고 아닌경우 거부한다
- 특정 [[firebase]] 서비스들과 통합된
  - firebase 의 특정 서비스를 사용할때 앱에서 발송된것이 확인된 트래픽만 허용
  - firebase 의 특정 서비스란 디비나 함수등을 사용하는 서비스
- 자체 서버에서도 사용할 수 있다 [[#커스텀 서비스(자체 백엔드)와의 통합]] 참조

## 커스텀 서비스(자체 백엔드)와의 통합
+ https://firebase.google.com/docs/app-check/web/custom-resource?hl=ko
+ https://firebase.google.com/docs/app-check/custom-resource-backend?hl=ko
- 요약하면 발송 주체에서 발행한 토큰을 헤더에 실어서 보내고 서버에서는 `firebase-admin-sdk` 를 통해서 검증하는 방식

### 한계
- 토큰은 api call 당 발행되는 토큰이다
- 발행된 토큰을 캡쳐해서 어뷰징을 하는 경운에는 컨셉이 무너진다
- 한계 극복을 위해 **재생보호** 라는 컨셉이 존재하며 한번 사용한 토큰이 재사용되는지를 확인하기 위해 서버에 다녀오는 방식이다
  - 이 경우 매 요청에 대해서 [[firebase]] 에 다녀와므로 지연이 추가된다
  - 공식문서에서도 지연에 민감한 곳에서는 사용하지 말기를 추천한다

## 도입시 고려할 점
- 앱을 새로개발하는 것을 기준으로 도입이 늦어지면 도입전 트래픽이 구버전 트래픽으로 남아있는 이상 트래픽이 막히는 이슈가 발생한다
- 강업등을 고려해야하므로 초기에 도입해두고 *활성화 여부는 사용 여부이므로* 서버에서 결정하는 것이니 추후에 결정해도 될 것으로 생각된다

## link
- [[firebase]]
